# Direct-to-Camera Comfort Template Design

**Status**: Implemented (Cycle 4)
**Date**: 2025-10-23 (Original), Updated 2025-10-29
**Branch**: `main`

---

## Template Identity

**ID**: `direct-to-camera_comfort`
**Name**: Direct-to-Camera Comfort
**Purpose**: Generate comforting video content where a person speaks directly to the viewer, providing emotional validation and gentle invitation to BibleChat

**Problem Solved**: Creates personalized comfort videos at scale with consistent character and emotional progression, addressing specific user problems with empathetic messaging.

---

## Template Purpose & Outcome

**Viewer Journey**:
1. Feels seen and validated in their struggle
2. Receives reassurance they're not alone
3. Gently invited to explore BibleChat for support

**Core CTA**: Try BibleChat for emotional and spiritual support

**Emotional Arc**: Recognition → Reassurance → Resource

---

## Workflow Structure

```
Input: UserProblem { category, problem }

Step 1: LLM Call 1 → Generate videoScript + voiceScript
        └─ videoScript: Scene 1 visual baseline
        └─ voiceScript: 50-60 words continuous dialogue

Step 2: LLM Call 2 → Generate 3 scene prompts
        └─ Uses videoScript + voiceScript as input
        └─ Scene 1: Full descriptive prompt
        └─ Scenes 2-3: Minimal prompts (expression changes only)

Step 3: Veo 3.1 → Generate Scene 1 (8 seconds)
Step 4: Extract last frame from Scene 1
Step 5: Veo 3.1 → Generate Scene 2 (8 seconds, with Scene 1 last frame)
Step 6: Extract last frame from Scene 2
Step 7: Veo 3.1 → Generate Scene 3 (8 seconds, with Scene 2 last frame)
Step 8: Combine 3 scenes → Final 24-second video

Output: 24-second comfort video with consistent character
```

**Workflow Characteristics**:
- Sequential LLM calls (Call 2 depends on Call 1 output)
- Frame chaining between scenes (character consistency)
- Always combines scenes into single video
- Fixed 3-scene structure

---

## Visual Format

### Video Specifications
```
Total Duration: 24 seconds (3 × 8-second scenes)
Aspect Ratio: 9:16 (vertical)
Resolution: 720p (configurable to 1080p)
Style: Professional comfort video
```

### Visual Requirements

**Scene 1 (Baseline)**:
```
✓ Person speaking directly to camera
✓ Warm home setting
✓ Concerned/empathetic expression
✓ Natural, simple description (no technical jargon)
✓ Full description: person, setting, expression, body language, mood
```

**Scenes 2-3 (Continuations)**:
```
✓ Same person (frame chaining ensures consistency)
✓ Same setting (image parameter handles this)
✓ Only describe expression/emotion shift
✓ Minimal prompts (10-30 words)
✓ Scene 2: Softening expression, reassuring
✓ Scene 3: Peaceful, hopeful expression
```

**Consistent Elements**:
- Same person throughout
- Same setting/framing
- Same lighting quality

**Varying Elements**:
- Expression: concerned → reassured → hopeful
- Posture: changes to reflect emotional shift
- Mood: tired → comforted → uplifted

---

## Audio Design

### Audio Source
```
Generated by Veo 3.1:
├─ Person speaks dialogue from voiceScript
├─ Natural voice with emotional inflection
└─ Ambient sounds from setting

Negative prompt: "background music" (to avoid unwanted music)
```

**Audio Characteristics**:
- Dialogue integrated into video generation
- Voice changes between scenes (acceptable POC limitation)
- No background music
- Natural ambient sounds

---

## Content Requirements

### Generated Fields

**videoScript** (Scene 1 Visual Baseline):
```
Purpose: Full visual description of Scene 1
Content:
- Person (age, clothing, expression)
- Setting (home basics)
- Body language and mood
- Natural and simple language
- No technical camera/lighting jargon

Used in: LLM Call 2 as foundation for Scene 1 prompt
```

**voiceScript** (Continuous Dialogue):
```
Purpose: Complete dialogue for all 3 scenes
Structure: 50-60 words total, following emotional arc

Breakdown:
- First ~20 words: Acknowledge their specific struggle (Scene 1)
- Next ~20 words: Reassure them they're not alone (Scene 2)
- Final ~20 words: Gently invite them to try BibleChat (Scene 3)

Tone: Warm, conversational, empathetic
Voice: Direct address ("you")

Used in: Embedded in scene prompts for Veo
```

**scenes[].prompt** (Veo Prompts):
```
Scene 1 - Full descriptive prompt (40-80 words):
- Foundation: videoScript
- Simplification: Remove overly specific props
- Keep: Person, setting type, mood, expression, body language, lighting
- Add: "actively speaking to camera"
- Add: First ~20 words from voiceScript as 'saying: "[dialogue]"'
- Format: Natural language for Veo

Scenes 2-3 - Minimal continuation (10-30 words):
- Do NOT describe setting (frame chaining handles this)
- Only: Expression/emotion shift from previous scene
- Add: Dialogue segment from voiceScript
- Format: "Person continues speaking with [expression change], saying: '[dialogue]'"
```

---

## Key Design Principles

### Two-Step Content Generation
```
Philosophy: Separate creative narrative from technical formatting

CALL 1: Creative Layer
├─ Generate story/content (videoScript + voiceScript)
├─ Focus: Natural language, empathetic messaging
└─ Output: Human-readable content

CALL 2: Technical Layer
├─ Transform content into Veo-optimized prompts
├─ Focus: Video generation requirements
└─ Output: Technical prompts for API

Benefits:
✓ Easier to debug (clear separation)
✓ More flexible (can refine each layer independently)
✓ Better quality (specialized prompts for each task)
```

### Frame Chaining Strategy
```
Purpose: Maintain character consistency across scenes

Implementation:
1. Generate Scene 1 → Extract last frame (frame 191 @ 24fps)
2. Pass last frame to Scene 2 as image parameter
3. Generate Scene 2 → Extract last frame
4. Pass last frame to Scene 3 as image parameter
5. Generate Scene 3

Result: Same person, same setting throughout video

Prompt Strategy:
- Scene 1: Full description (establishes visual baseline)
- Scenes 2-3: Minimal description (image provides context)
- Verbose Scene 2-3 prompts cause conflicts with image parameter
```

### Dialogue Integration
```
Strategy: Embed dialogue in Veo prompts

Format: 'person saying: "[exact dialogue from voiceScript]"'

Scene Division:
- Scene 1: First ~20 words
- Scene 2: Middle ~20 words
- Scene 3: Final ~20 words

Note: Voice changes between scenes (POC limitation, acceptable)
```

### Emotional Arc Pattern
```
Scene 1: Recognition/Validation
├─ Purpose: Acknowledge the struggle
├─ Expression: Concerned, empathetic, warm
└─ Dialogue: "I know [specific problem]..."

Scene 2: Reassurance/Comfort
├─ Purpose: You're not alone
├─ Expression: Softening, gentle smile, reassuring
└─ Dialogue: "You're not alone in this..."

Scene 3: Resource/Invitation
├─ Purpose: Gentle BibleChat invitation
├─ Expression: Peaceful, hopeful, confident
└─ Dialogue: "Try BibleChat for support..."

Pattern: Recognition → Reassurance → Resource
```

---

## System Prompts

### LLM Call 1: Content Generation

**System Prompt**:
```
{{variety_instruction}}

You are creating a comfort video. A person speaks directly to camera in a warm home setting.

Generate TWO fields:

1. videoScript - Describe Scene 1 visuals in simple terms:
   - The person (age, clothing, expression)
   - The setting (home basics)
   - Body language and mood
   Keep it natural and simple. No technical camera/lighting jargon.

2. voiceScript - 50-60 words of dialogue with this structure:
   - First ~20 words: Acknowledge their specific struggle
   - Next ~20 words: Reassure them they're not alone, it's okay to feel this way
   - Final ~20 words: Gently invite them to try BibleChat for support

Tone: Warm, conversational, empathetic. Speak directly to "you."
```

**User Prompt**:
```
Category: {category}
Problem: {problem}

Generate a 3-scene video script addressing this specific problem.
```

**Variables**:
- `variety_instruction`: Controls setting/person diversity (future enhancement)

---

### LLM Call 2: Prompt Optimization

**System Prompt**:
```
{{dialogue_instruction}}

You are optimizing visual descriptions for Veo 3.1 video generation.

Input:
- videoScript (Scene 1 baseline description)
- voiceScript (50-60 words continuous dialogue)

Generate 3 scene prompts following this strategy:

Scene 1 - Full descriptive prompt:
- Use videoScript as foundation
- Simplify: Remove overly specific props (no "wedding photo" or "spreadsheet on laptop")
- Keep: Person, setting type, mood, expression, body language, lighting quality
- Add: "actively speaking to camera"
- If including dialogue: Add first ~20 words from voiceScript in format 'saying: "[dialogue]"'
- Format for Veo: Natural language, 40-80 words

Scene 2 - Minimal continuation:
- Do NOT describe setting (image parameter handles this)
- Only: Expression/emotion shift from Scene 1
- If including dialogue: Add middle ~20 words from voiceScript
- Format: "Person continues speaking with [expression change], saying: '[dialogue]'"
- 10-30 words maximum

Scene 3 - Minimal continuation:
- Same as Scene 2 rules
- If including dialogue: Add final ~20 words from voiceScript
- Focus on final emotional shift

Remember: Scenes 2-3 use frame chaining - the image parameter provides visual context, so verbose descriptions cause conflicts.
```

**User Prompt**:
```
videoScript: {videoScript}

voiceScript: {voiceScript}

Generate 3 Veo-optimized scene prompts following the strategy above.
```

**Variables**:
- `dialogue_instruction`: Controls whether dialogue appears in prompts (future enhancement)

---

## Technical Implementation

### Veo 3.1 Parameters
```typescript
{
  prompt: scene.prompt,
  aspect_ratio: "9:16",
  duration: 8,
  resolution: "720p",
  generate_audio: true,
  negative_prompt: "background music",
  image: previousSceneLastFrame  // Scenes 2-3 only
}
```

### Frame Extraction
```bash
# Extract last frame (frame 191 @ 24fps for 8-second video)
ffmpeg -i scene.mp4 -vf "select='eq(n,191)'" -frames:v 1 last_frame.jpg

# Convert to data URL for Replicate API
base64_frame=$(base64 < last_frame.jpg)
data_url="data:image/jpeg;base64,${base64_frame}"
```

### Scene Combination
```bash
# Create concat file
echo "file 'scene1.mp4'" > concat.txt
echo "file 'scene2.mp4'" >> concat.txt
echo "file 'scene3.mp4'" >> concat.txt

# Combine with ffmpeg
ffmpeg -f concat -safe 0 -i concat.txt -c copy final.mp4
```

---

## Testing & Validation

### Validation Criteria
```
✓ videoScript is Scene 1 visual baseline (not meta-description)
✓ voiceScript is 50-60 words following arc structure
✓ Scene 1 prompt is detailed (40-80 words)
✓ Scenes 2-3 prompts are minimal (10-30 words)
✓ No background music in generated videos
✓ Dialogue matches voiceScript split (~20 words each)
✓ Character consistency across scenes
✓ Emotional progression visible
```

### Performance Metrics
```
Cost per video: ~$0.30 (3 scenes × $0.10 per 8s)
Time per video: 9-15 minutes (3 scenes × 3-5 min each)
LLM calls: 2 per video (sequential)
Total duration: 24 seconds
```

---

## Design Decisions & Learnings

### Decision 1: videoScript as Visual Baseline
**Date**: October 23, 2025

**Previous approach**: overallScript as meta-description

**New approach**: videoScript as functional Scene 1 description

**Reasoning**:
- Eliminates redundancy (was describing same thing multiple ways)
- Becomes functional baseline instead of meta-commentary
- Aligns with frame chaining (Scene 1 full, 2-3 minimal)

---

### Decision 2: Two-Step LLM Process
**Date**: October 23, 2025

**Rationale**:
- Separates creative (narrative) from technical (Veo formatting)
- Easier to debug and refine each layer
- CALL 1 focuses on empathetic content
- CALL 2 focuses on video generation optimization

**Alternative considered**: Single LLM call (rejected for mixing concerns)

---

### Decision 3: Minimal Scenes 2-3 Prompts
**Date**: October 23, 2025

**Issue**: Verbose Scene 2-3 prompts conflict with frame chaining

**Solution**: Only describe expression changes in Scenes 2-3

**Result**: Better character consistency, fewer conflicts

---

### Learning: Frame Chaining Data URLs
**Date**: October 27, 2025

**Issue**: Local file paths caused 422 errors

**Solution**: Convert extracted frames to base64 data URLs

**Format**: `data:image/jpeg;base64,{base64string}`

---

## Comparison to Other Templates

| Aspect | D2C Comfort | UGC-Action Lockscreen |
|--------|-------------|----------------------|
| **Scenes** | 3 scenes (24s total) | 1 scene (4-6s) |
| **LLM Calls** | 2 sequential | 2 parallel |
| **Frame Chaining** | Yes (character consistency) | No (single clip) |
| **Assembly** | Always combines 3 scenes | No combining |
| **Emotion** | Explicit in script/prompts | Implied, not stated |
| **Person** | Looking at camera, speaking | Not looking, silent action |
| **Audio** | Veo generates dialogue | Voiceover + ambient |
| **Style** | Professional comfort video | Raw UGC aesthetic |
| **Purpose** | Emotional support & validation | Promote lockscreen feature |
| **CTA** | Try BibleChat for support | Add verses to lockscreen |

---

## Variables & Flexibility

### Current Variables (POC)
```
variety_instruction: Hardcoded (future: controls setting/person diversity)
dialogue_instruction: Hardcoded (future: toggles dialogue in prompts)
```

### Future Flexibility Points
```
- Setting variations (home, office, outdoor)
- Person characteristics (age, gender, ethnicity)
- Dialogue phrasing variations
- Tone adjustments (warm, gentle, hopeful)
- Scene count (currently fixed at 3)
```

---

## Related Documentation

- **Multi-Template Exploration**: `_docs/1_development-docs/multi-template-system-exploration.md`
- **Template Design Framework**: `_docs/2_reference-docs/template-design-full.md`
- **Implementation Plan**: `_docs/2_reference-docs/temp-implementation.md`
- **Cycle 4 Complete**: `_docs/1_development-docs/cycle-4/IMPLEMENTATION-COMPLETE.md`
- **Workflow Documentation**: `_docs/2_reference-docs/workflow-problems-and-solutions-2.md`

---

**End of Template Design Document**
