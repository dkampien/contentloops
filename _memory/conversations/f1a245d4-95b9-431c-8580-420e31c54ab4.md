# Comic Book Template - Hybrid Approach & Thumbnail Implementation

## Context
Completed comic book template workflow validation by solving text generation reliability issues, implementing a hybrid approach (dialogue in images + narration in app UI), and adding thumbnail generation for app grid view.

## Tracking Points

**Solution Implemented: Hybrid Approach (Dialogue + App UI Text)**
- **Problem:** AI models struggle with 5+ text elements per page (captions + speech bubbles)
  - Text garbling: "I come in the you come name of the Lord"
  - Speech bubble pointers misplaced
  - Caption style inconsistency
- **Failed Approaches:**
  - Two-step generation (text-free → add text via i2i): Does not work
  - Split dialogue first, then captions via i2i: Does not work
  - All documented in testing.md
- **Solution:** Generate images at variable aspect ratio (3:4, 2:3, 4:5) with ONLY dialogue (2-3 speech bubbles max)
  - Page narration displayed in app UI text overlay below comic (not in generated image)
  - Narration 100% reliable, translatable, updatable
  - Reduces AI text generation errors significantly

**Decision: Page-Sectioned Narrative Structure**
- Step 1: Write 150-word narrative structured into [PAGE 1], [PAGE 2], [PAGE 3], [PAGE 4] sections
- Each section becomes that page's app UI narration
- Sections combine to form complete 150-word story
- **Benefit:** Scalable - no manual chunking needed, works for any page count
- Step 3 page scripts now reference Step 1 sections (no duplication)

**Implementation: story-data.json Format**
- Created JSON structure for dev handoff
- Fields: storyId, title, thumbnailFile, totalPages, pages[]
- Each page: pageNumber, imageFile, narration (from Step 1 sections)
- No dialogue in JSON (already in generated images)

**New Requirement: Thumbnail Generation**
- Added Step 5 to template workflow
- Purpose: Cover/thumbnail for app 2x2 grid view
- Requirements: Portrait orientation, composite scene, title text on image, same art style
- Generated David & Goliath thumbnail successfully
- **Challenge Identified:** Font consistency unpredictable across AI generations
  - Text style can vary (thickness, outline weight, exact font)
  - Solutions noted: Generate without text + programmatic overlay (Python/PIL, ImageMagick, Node.js), more specific prompts, or manual overlay
  - Keeping AI-generated text for now with note about potential need for programmatic overlay

**Status: Template Complete**
- Step 1: Page-sectioned 150-word narrative
- Step 2: Page & panel planning
- Step 3: Page scripts (visuals, composition, dialogue only)
- Step 4: Prompt generation (dialogue-only, variable aspect ratio)
- Step 5: Thumbnail generation (composite scene with title)
- All 5 steps validated with David & Goliath

**Status: Stories Created**
- David & Goliath: ✅ Complete (narrative, scripts, prompts, story-data.json, thumbnail tested)
- Noah's Ark: ✅ Scripts/prompts ready (needs update to new workflow)
- story-backlog.md: 30 story ideas for scaling

**Token Consumption Data**
- Per-story production cost: ~10k tokens (5k file content, 5k overhead)
- Can produce ~12-13 stories per conversation (200k limit)

**Output Structure Established**
```
output/comic-book-bible-stories/
  [story-name]/
    ├── thumbnail.png
    ├── page1.png, page2.png, page3.png, page4.png
    └── story-data.json
```

**Key Technical Details**
- Images: Variable aspect ratio (testing 3:4, 2:3, 4:5), dialogue only
- App display: 9:16 screen with comic image + narration text below
- Text load: 2-3 speech bubbles per page (vs previous 5+ with captions)
- Models tested: seedream-4 (100% success), nano-banana (50% success + style issues)

**Open Item: Block Library**
- "Validate block library structure supports the work" todo remains pending
- Discussion about LLM suggesting new blocks happened in different thread
- prompt-blocks.json exists but mostly empty schema

## Related Files/Artifacts
- `_templates/comic-book-bible-stories/template.md` - Complete 5-step workflow
- `_templates/comic-book-bible-stories/testing.md` - Caption testing, two-step failure, thumbnail testing documented
- `_templates/comic-book-bible-stories/stories/noahs-ark.md` - Second story created
- `_templates/comic-book-bible-stories/stories/story-backlog.md` - 30 story ideas
- `output/comic-book-bible-stories/david-and-goliath/story-data.json` - JSON format with thumbnail field
- `output/comic-book-bible-stories/README.md` - Updated with thumbnail and text overlay notes
