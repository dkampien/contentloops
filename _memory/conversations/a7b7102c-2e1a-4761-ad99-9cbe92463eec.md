# Comic Book Template Design and Block Library Conversion

## Context
Designed complete workflow for generating Bible story comics as in-app content for SoulStream. Converted block library from markdown to JSON and established page-first production workflow through end-to-end testing.

## Tracking Points

**Decision: Block Library → JSON Format**
- Converted `prompt-blocks.json` from markdown to nested JSON structure
- Organization: Single file, semantic categories (scene, composition, lighting, etc.)
- No metadata (modality/domain tags) yet - start simple, add if needed
- Philosophy: "When in doubt, simplify" - evolve based on actual needs
- Location: `_docs/2_reference-docs/prompt-blocks.json`

**Decision: Template-Specific Blocks Strategy**
- Keep main library lean - only universal/proven reusable blocks
- Template-specific blocks go in template testing docs initially
- Promote to main library only after proving reusable across multiple templates
- For comic template: Layout, text integration, comic style blocks being tested

**Discovery: Comic Production Workflow (Page-First)**
- Clarified: Panel = compartment/frame, Page = one image generation (1-4 panels), Story = multiple pages
- Established 4-step workflow:
  1. Story Narrative (150 words)
  2. Page & Panel Planning (decide page count, distribute story beats, assign grid layouts)
  3. Individual Page Scripts (VISUAL, COMPOSITION, NARRATION, DIALOGUE per panel)
  4. Prompts (blocks → formula → final prompts per page)
- Page-first approach works because: traditional comic principles guide structure, enables planning story pacing, aligns with professional workflow
- Each page script includes grid layout decision (Layout A/B/C = 1/2/3 panels vertical)

**Critical Learning: Block Mapping Must Be Documented**
- Initial mistake: Added complete examples but dropped the "blocks identified" sections that show script → blocks → prompt transformation
- Without explicit block mapping, future conversations can't reproduce the logic
- Solution: All story files now include detailed block mappings showing the transformation
- This makes prompts reproducible, not just copyable

**Testing Results: Model Comparison (4-page David & Goliath story)**
- **seedream-4:** 100% first-try success (4/4 pages), highly reliable
- **nano-banana:** 50% first-try success (2/4 pages), required 2-4 retries on later pages
- Both models CAN generate 3-panel pages with speech bubbles successfully
- Prompt detail level: Medium works well (not sparse, not overwhelming)

**Blocker: Style Consistency Across Pages**
- Problem: Each page = independent generation, models don't "remember" previous pages
- nano-banana: Style drift between pages (different colors, line styles) - major issue
- seedream-4: Style consistency not yet tested but more reliable overall
- Attempted fix: Used Page 1 as style reference → "kinda worked" (partial improvement)
- Proposed solution: Create dedicated style reference image, apply to ALL page generations

**Discovery: Prompt Writing Best Practices**
- ✅ Works: Describe characters visually (not by name), concrete details, specify panel layout clearly
- ❌ Doesn't work: Character names expecting cultural knowledge ("David", "Goliath"), model parameters in prompt ("9:16 format"), redundant instructions
- Effective template: `A [N]-panel comic book page, [layout], [art style]. PANEL 1 ([position]): [visual description]. [composition]. [Speech bubble if needed]`

**Decision: File Organization Structure**
- User has `_templates/` folder at root level
- Comic template organized as folder with sub-files (not single doc):
  - `template.md` - Reference doc with workflow, blocks, best practices
  - `testing.md` - Testing results and learnings
  - `stories/` - Individual story files with all 4 steps + block mappings
  - `stories/stories-index.md` - Registry tracking 30 planned stories
- Original testing doc preserved at `_docs/2_reference-docs/template-testing/comic-book-bible-stories.md`
- Rationale: Keep template reference separate from testing notes and production output

**Status: Comic Template Production Ready**
- Complete workflow documented with explicit block mappings
- 2 complete story examples (David & Goliath, Noah's Ark) with all 4 steps
- Grid layouts defined: A = 1 panel fullscreen, B = 2 panels vertical, C = 3 panels vertical
- Ready for: Bulk story production (28 more stories planned), style reference testing
- seedream-4 recommended as primary model for production

**Pattern: Multi-Story Production Planning**
- Planning 30 Bible stories total
- Each story = separate markdown file with all 4 steps
- Stories tracked in index with status (Complete/In Progress/Planned)
- Stories are production output, kept with template for convenience

## Related Files/Artifacts
- `_templates/comic-book-bible-stories/template.md` - Complete workflow reference with block definitions
- `_templates/comic-book-bible-stories/testing.md` - Testing results and model comparison
- `_templates/comic-book-bible-stories/stories/stories-index.md` - Registry of 30 stories (2 complete)
- `_templates/comic-book-bible-stories/stories/david-and-goliath.md` - First complete story with block mappings
- `_templates/comic-book-bible-stories/stories/noahs-ark.md` - Second complete story with block mappings
- `_docs/2_reference-docs/prompt-blocks.json` - Main block library (JSON format)
- `_docs/2_reference-docs/template-testing/comic-book-bible-stories.md` - Original combined doc (preserved)
