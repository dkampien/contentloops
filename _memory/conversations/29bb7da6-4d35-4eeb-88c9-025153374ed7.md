# CustomGPT Comic Book Prompt Generation - Problems Analysis & Testing

## Context
Extensive debugging of CustomGPT-based prompt generation system for Bible story comic books. Tested with 13+ stories, identified systematic failures, explored solutions including separate panel generation workflow.

## Tracking Points

**Status: Blocked** - LLM cannot follow instructions consistently for prompt generation despite comprehensive framework/template

**Key Discovery: Separate Panel Generation Works Better**
- Tested generating 3 panels separately vs 3-in-one format
- Separate panels (Panel 1: 3:4, Panel 2: 3:4, Panel 3: 3:2) showed better character consistency
- Requires programmatic composition (AI composition fails - models modify images)
- Python Pillow solution: ~30 min implementation, creates 2-over-1 layout (3:4 final page)

**Problems Documented:**
- Generation Output Issues: consistency/continuity, location changes, character drift, latent bleeding, dialogue placement
- Prompt Structure Issues: undefined references, verbose language, not camera-visible, lack of specificity, element overload
- Full list saved to: `_memory/conversations/comic-prompt-problems-and-solutions.md`

**Prompt Writing Patterns That Work:**
- Composite elements in single sentence: "Donkey carries injured man" (not separate sentences - creates duplicates)
- Simple dialogue format: "The younger man says: 'text'" (spatial positioning fails)
- Natural flowing sentences, not attribute lists
- Camera-visible only: "sneering face, furrowed brow" not "intimidating"
- 2-3 speech bubbles max per page
- 3-5 core elements max per panel
- Specific quantities: "three sons" not "family"

**System Prompt Status:**
- v3.2 template + framework docs stored in: `_memory/cursor-notepads/dump8-gpt-system-prompt.md`
- 5-step workflow: Story Narrative → Page Planning → Prompt Generation → Thumbnail → Story Data JSON
- Character consistency rules added but not working reliably
- Loaded keywords management (use once in Panel 1 only)

**Manual Prompt Refinement Process Established:**
- Review CustomGPT output
- Remove character names (use visual descriptions only)
- Remove spatial positioning ("on left/right")
- Simplify dialogue (2 max per page, simple format)
- Ensure natural sentence flow

**Failed Approaches:**
- Character glossary at page level (tags get confused, roles swapped)
- Spatial dialogue positioning ("Character on left says to character on right")
- 3-panel-in-one with complex descriptions (keyword bleeding, error multiplication)
- AI composition tools (NanoBanana modifies images instead of stitching)

**Decision: Two Possible Paths Forward**
1. Fix 3-panel-in-one prompting (current approach, not working)
2. Separate panel generation + programmatic composition (tested successfully, requires automation)

**Files Created:**
- Story backlog for kids: `_templates/comic-books-kids/story-backlog.md` (15 stories)
- Output folders: `output/comic-books-kids/01-david-and-goliath/` through `15-jesus-walks-water/`
- Problems doc: `_memory/conversations/comic-prompt-problems-and-solutions.md`
- Separate panel workflow context: `_memory/conversations/comic-panel-composition-context.md`

**Open Questions:**
- How to make LLM follow complex instructions consistently?
- Should pivot to separate panel workflow despite 3x cost and composition complexity?
- Can prompt structure issues be solved with better instructions or is it model limitation?

**Next Steps (Unresolved):**
- User out of ideas for improving LLM instruction-following
- Need to decide: continue fixing current approach or pivot to separate panels + automation
- If pivoting: need to build Python composition script and update CustomGPT for 3 separate prompts per page

## Related Files/Artifacts
- System prompt: `_memory/cursor-notepads/dump8-gpt-system-prompt.md`
- Problems documentation: `_memory/conversations/comic-prompt-problems-and-solutions.md`
- Separate panel approach: `_memory/conversations/comic-panel-composition-context.md`
- Kids backlog: `_templates/comic-books-kids/story-backlog.md`
- Template v3.2: `_templates/comic-books/comic-books_template_v3.2.md`
